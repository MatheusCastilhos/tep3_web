<!-- UNIVERSIDADE FEDERAL DE CI√äNCIAS DA SA√öDE DE PORTO ALEGRE - UFCSPA
Nome: Matheus Castilhos
Disciplina: T√≥picos Especiais de Programa√ß√£o III
Curso: Inform√°tica Biom√©dica
Atividade Pr√°tica 2
-->
<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Painel de Dados da COVID-19</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Chart.js  -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <!-- Overlay de carregamento  -->
  <style>
    #countryLoading {
      position: fixed; inset: 0; z-index: 1050;
      background: rgba(248,249,250,.92);
      display: none; align-items: center; justify-content: center;
      backdrop-filter: blur(2px);
    }
    #countryLoading .loader {
      display: flex; flex-direction: column; align-items: center; gap: .75rem;
    }
  </style>
  <div id="countryLoading" aria-live="polite" aria-busy="true">
    <div class="loader text-center">
      <div class="spinner-border" role="status" aria-label="Carregando"></div>
      <div class="mt-2">Carregando dados do pa√≠s...</div>
    </div>
  </div>


  <body class="bg-light">
    <div class="container py-4">

      <!-- Cabe√ßalho -->
      <header class="mb-3 text-center">
        <h1 class="h3 mb-1">Painel de Dados da COVID-19</h1>
        <div class="text-muted">feito por <strong>Matheus Castilhos</strong></div>
      </header>
      <hr class="mt-2 mb-3 border-secondary-subtle">

      <!-- √Årea de alertas -->
      <div id="alertArea" class="mb-3"></div>

      <!-- ====== VIEW 1: BOAS-VINDAS ====== -->
      <section id="welcomeView" class="py-5">
        <div class="row justify-content-center">
          <div class="col-12 col-lg-8">
            <div class="card shadow-sm">
              <div class="card-body p-4 text-center">
                <h2 class="h4 mb-3">Bem-vindo ao Painel de Dados da COVID-19</h2>
                <p class="text-muted mb-3">
                    Este painel consolida informa√ß√µes p√∫blicas sobre COVID-19 por <strong>pa√≠s</strong> e por <strong>l√≠ngua</strong>, usando dados em tempo real das APIs <em>disease.sh</em> e <em>RestCountries</em>. Ele foi desenvolvido para praticar consumo de APIs, organiza√ß√£o de dados e visualiza√ß√£o interativa.
                </p>

                <ul class="text-start small mb-4">
                    <li><strong>Ranking de pa√≠ses:</strong> mostra, para cada pa√≠s, <em>Vacina√ß√£o (%)</em> e <em>Mortes (%)</em>. √â poss√≠vel <u>ordenar</u> por m√©trica e dire√ß√£o, <u>paginar</u> os resultados e <u>buscar</u> pelo nome do pa√≠s.</li>
                    <li><strong>Ranking por l√≠ngua:</strong> agrega pa√≠ses por l√≠nguas oficiais, exibindo <em>Vacina√ß√£o (%)</em>, <em>Mortes (%)</em>, <em>Popula√ß√£o total</em> e <em>n√∫mero de pa√≠ses</em>, com ordena√ß√£o e pagina√ß√£o.</li>
                    <li><strong>Detalhe do pa√≠s:</strong> ao clicar num pa√≠s, abre-se uma tela dedicada com bandeira, popula√ß√£o, l√≠nguas e tr√™s gr√°ficos: hist√≥rico de <em>casos/dia</em> e <em>√≥bitos/dia</em>, evolu√ß√£o de <em>vacina√ß√£o acumulada</em> e a distribui√ß√£o atual entre <em>ativos</em>, <em>recuperados</em> e <em>√≥bitos</em>.</li>
                    <li><strong>Observa√ß√£o sobre Vacina√ß√£o (%):</strong> o valor usa <em>doses aplicadas √∑ popula√ß√£o</em>. Por considerar m√∫ltiplas doses por pessoa, o percentual pode ultrapassar 100%.</li>
                    <li><strong>Acessibilidade e UX:</strong> indicadores de carregamento, mensagens de erro e navega√ß√£o sem recarregar a p√°gina (SPA) para uma experi√™ncia fluida.</li>
                    <li><strong>Limita√ß√µes de dados:</strong> alguns pa√≠ses carecem de campos ou s√©ries hist√≥ricas completas nas APIs. Nessas situa√ß√µes, certos cart√µes ou gr√°ficos podem n√£o aparecer e a p√°gina de detalhes pode n√£o carregar como esperado. O painel exibe mensagens de erro e mant√©m a navega√ß√£o est√°vel.</li>
                    <li><strong>Fontes:</strong> disease.sh (COVID-19) e RestCountries (metadados de pa√≠ses e l√≠nguas).</li>
                </ul>

                <p class="text-muted mb-4">
                Para come√ßar, clique no bot√£o abaixo. O painel ir√° buscar os dados mais recentes, montar os rankings e habilitar a navega√ß√£o para os detalhes por pa√≠s.
                </p>

                <div class="d-flex flex-column align-items-center gap-2">
                  <button id="btnGerar" class="btn btn-primary btn-lg">
                    <span id="spinBtn" class="spinner-border spinner-border-sm me-2 d-none" role="status" aria-hidden="true"></span>
                    <span id="btnLabel">Gerar ranking</span>
                  </button>
                  <small id="status" class="text-secondary"></small>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ====== VIEW 2: DASHBOARD ====== -->
      <section id="dashboardView" class="d-none">
        <div class="row g-4">
          <!-- RANKING DE PA√çSES -->
          <div class="col-12 col-lg-6">
            <div class="card shadow-sm">
              <div class="card-header d-flex flex-wrap align-items-center gap-3">
                <span>Ranking de pa√≠ses</span>
                <span id="badgeTotalPaises" class="badge text-bg-secondary d-none"></span>

                <!-- Controles √† direita -->
                <div class="ms-auto d-flex flex-wrap align-items-center gap-2">
                  <!-- Busca por nome do pa√≠s -->
                  <div class="input-group input-group-sm" style="width: 220px;">
                    <span class="input-group-text" id="lblBuscaPais">üîé</span>
                    <input
                      id="buscaPais"
                      type="search"
                      class="form-control"
                      placeholder="Buscar pa√≠s..."
                      aria-label="Buscar pa√≠s"
                      aria-describedby="lblBuscaPais"
                    />
                  </div>

                  <!-- Ordena√ß√£o -->
                  <select id="ordenarPor" class="form-select form-select-sm" style="width:auto;">
                    <option value="pctVac" selected>Vacina√ß√£o (%)</option>
                    <option value="pctMortes">Mortes (%)</option>
                  </select>
                  <select id="direcao" class="form-select form-select-sm" style="width:auto;">
                    <option value="desc" selected>Maior ‚Üí Menor</option>
                    <option value="asc">Menor ‚Üí Maior</option>
                  </select>
                </div>
              </div>

              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped align-middle mb-0" id="tabelaRanking">
                    <thead class="table-light">
                      <tr>
                        <th style="width:60px;">#</th>
                        <th>Pa√≠s <small class="text-muted">(clique para ver detalhes)</small></th>
                        <th class="text-end">Vacina√ß√£o (%)</th>
                        <th class="text-end">Mortes (%)</th>
                      </tr>
                    </thead>
                    <tbody><!-- Linhas via JS --></tbody>
                  </table>
                </div>

                <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-3 gap-2">
                  <small id="paginaInfo" class="text-muted"></small>
                  <nav class="d-flex justify-content-center">
                    <ul id="paginacaoPaises" class="pagination pagination-sm mb-0"></ul>
                  </nav>
                </div>
              </div>
            </div>
          </div>

          <!-- RANKING POR L√çNGUA -->
          <div class="col-12 col-lg-6">
            <div class="card shadow-sm">
              <div class="card-header d-flex flex-wrap align-items-center gap-3">
                <span>Ranking por L√≠ngua</span>
                <span id="badgeTotalLinguas" class="badge text-bg-secondary d-none"></span>
                <div class="ms-auto d-flex flex-wrap align-items-center gap-2">
                  <select id="ordenarPorLingua" class="form-select form-select-sm" style="width:auto;">
                    <option value="pctVac" selected>Vacina√ß√£o (%)</option>
                    <option value="pctMortes">Mortes (%)</option>
                    <option value="populacao">Popula√ß√£o total</option>
                  </select>
                  <select id="direcaoLingua" class="form-select form-select-sm" style="width:auto;">
                    <option value="desc" selected>Maior ‚Üí Menor</option>
                    <option value="asc">Menor ‚Üí Maior</option>
                  </select>
                </div>
              </div>

              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-striped align-middle mb-0" id="tabelaLingua">
                    <thead class="table-light">
                      <tr>
                        <th style="width:60px;">#</th>
                        <th>L√≠ngua</th>
                        <th class="text-end">Vacina√ß√£o (%)</th>
                        <th class="text-end">Mortes (%)</th>
                        <th class="text-end">Popula√ß√£o total</th>
                        <th class="text-end">Pa√≠ses (contagem)</th>
                      </tr>
                    </thead>
                    <tbody><!-- Linhas via JS --></tbody>
                  </table>
                </div>

                <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-3 gap-2">
                  <small id="paginaInfoLingua" class="text-muted"></small>
                  <nav class="d-flex justify-content-center">
                    <ul id="paginacaoLinguas" class="pagination pagination-sm mb-0"></ul>
                  </nav>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ====== VIEW 3: DETALHE POR PA√çS ====== -->
      <section id="countryView" class="container py-4 d-none">
        <header class="mb-3 d-flex align-items-center gap-3">
          <img id="cty-flag" alt="Bandeira" width="48" height="32" style="object-fit:cover;border:1px solid #ddd;border-radius:4px;">
          <div>
            <h2 id="cty-title" class="h4 mb-0">Pa√≠s</h2>
            <small id="cty-sub" class="text-muted">Regi√£o ‚Ä¢ Popula√ß√£o ‚Ä¢ L√≠nguas</small>
          </div>
          <button id="btnBack" class="btn btn-outline-secondary ms-auto" type="button" aria-label="Voltar ao dashboard">
            ‚Üê Voltar
          </button>
        </header>

        <!-- Cards de n√∫meros atuais -->
        <div class="row g-3 mb-3" id="cty-stats">
        </div>

        <!-- Gr√°ficos -->
        <div class="row g-4">
          <div class="col-12 col-lg-6">
            <div class="card h-100 shadow-sm">
              <div class="card-body">
                <h5 class="card-title">Casos e √ìbitos (hist√≥rico)</h5>
                <div style="height:300px">
                  <canvas id="chart-history" aria-label="Hist√≥rico de casos e √≥bitos" role="img"></canvas>
                </div>
                <small class="text-muted">Fonte: disease.sh (dados hist√≥ricos)</small>
              </div>
            </div>
          </div>

          <div class="col-12 col-lg-6">
            <div class="card h-100 shadow-sm">
              <div class="card-body">
                <h5 class="card-title">Vacina√ß√£o (acumulado)</h5>
                <div style="height:300px">
                  <canvas id="chart-vax" aria-label="Vacina√ß√£o acumulada" role="img"></canvas>
                </div>
                <small class="text-muted">Cobertura de vacina√ß√£o ao longo do tempo</small>
              </div>
            </div>
          </div>

          <div class="col-12 col-lg-6">
            <div class="card h-100 shadow-sm">
              <div class="card-body">
                <h5 class="card-title">Situa√ß√£o Atual</h5>
                <div style="height:300px">
                  <canvas id="chart-pie" aria-label="Distribui√ß√£o atual" role="img"></canvas>
                </div>
                <small class="text-muted">Ativos √ó Recuperados √ó √ìbitos</small>
              </div>
            </div>
          </div>
        </div>

        <div id="cty-status" class="mt-3 text-muted"></div>
      </section>

      <!-- Rodap√© opcional -->
      <footer class="mt-4 text-center text-muted small">Atualizado dinamicamente via APIs disease.sh e RestCountries | UFCSPA 2025</footer>
    </div>

    <!-- Bootstrap JS (bundle) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Script -->
    <script src="script.js"></script>
  </body>
</html>